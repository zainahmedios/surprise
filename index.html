<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <title>Mobile Slide Demo</title>

    <!-- Tailwind (CDN) for quick styling -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React + ReactDOM (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Framer Motion (UMD) -->
    <script src="https://unpkg.com/framer-motion/dist/framer-motion.umd.js"></script>

    <!-- Babel so we can write JSX right in this file -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
      /* Make the viewport behave nicely on mobile */
      html, body, #root { height: 100%; margin: 0; }
    </style>
  </head>
  <body class="bg-gradient-to-b from-emerald-50 via-sky-50 to-yellow-50">
    <div id="root"></div>

    <script type="text/babel">
      const { useState, useRef, useEffect } = React;
      const { motion, AnimatePresence } = window.framerMotion;

      function MobileSlideDemo() {
        const [visible, setVisible] = useState(true);
        const [videoEnded, setVideoEnded] = useState(false);
        const videoRef = useRef(null);
        const speed = 5; // seconds, fixed

        useEffect(() => {
          if (!visible && videoRef.current) {
            try {
              videoRef.current.currentTime = 0;
              const p = videoRef.current.play();
              if (p && typeof p.catch === "function") {
                p.catch(err => console.warn("Autoplay blocked:", err));
              }
            } catch (e) {
              console.warn("Autoplay failed:", e);
            }
          }
        }, [visible]);

        return (
          <div className="min-h-[100dvh] w-full text-neutral-800 flex flex-col items-center justify-between p-4 select-none">
            {/* Header */}
            <header className="w-full max-w-md pt-6">
              <h1 className="text-2xl font-semibold tracking-tight text-emerald-700">
                Interactive Demo
              </h1>
              <p className="text-sm text-neutral-600 mt-1">
                Tap the square. It slides away and smoothly reveals a video. Reset to try again.
              </p>
            </header>

            {/* Play Area */}
            <div className="relative w-full max-w-md flex-1 grid place-items-center overflow-hidden">
              <AnimatePresence>
                {visible && (
                  <motion.div
                    key="square"
                    initial={{ y: 0, opacity: 1, scale: 1 }}
                    whileTap={{ scale: 0.95 }}
                    animate={{ y: 0, opacity: 1 }}
                    exit={{ y: 600, opacity: 0 }}
                    transition={{ duration: speed, ease: [0.22, 1, 0.36, 1] }}
                    onClick={() => { setVisible(false); setVideoEnded(false); }}
                    className="w-40 h-40 rounded-2xl bg-gradient-to-br from-emerald-200 to-sky-200 shadow-xl shadow-emerald-200/40 grid place-items-center cursor-pointer"
                  >
                    <div className="text-center">
                      <div className="text-lg font-medium">Tap me</div>
                      <div className="text-xs opacity-80">to slide away</div>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>

              {/* Video that appears smoothly as square disappears */}
              <AnimatePresence>
                {!visible && (
                  <motion.div
                    key="video"
                    initial={{ opacity: 0, y: 30 }}
                    animate={{ opacity: 1, y: 0 }}
                    exit={{ opacity: 0 }}
                    transition={{ duration: 1.2, ease: "easeOut" }}
                    className="absolute inset-0 flex items-center justify-center"
                  >
                    <div className="rounded-2xl border border-emerald-200 shadow-lg max-w-full max-h-[70%] bg-white grid place-items-center p-6 text-neutral-500">
                      <video
                        ref={videoRef}
                        autoPlay
                        muted
                        playsInline
                        preload="auto"
                        crossOrigin="anonymous"
                        onLoadedData={() => {
                          try { videoRef.current?.play(); } catch {}
                        }}
                        onEnded={() => setVideoEnded(true)}
                        className="w-full h-full object-cover rounded-lg"
                      >
                        <source
                          src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4"
                          type="video/mp4"
                        />
                        Sorry, your browser can't play this video.
                      </video>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>

            {/* Bottom button appears only when video is done */}
            <div className="w-full max-w-md pb-6">
              <div className="flex items-center justify-center">
                <AnimatePresence>
                  {videoEnded && (
                    <motion.div
                      key="bottom-btn"
                      initial={{ opacity: 0, y: 8 }}
                      animate={{ opacity: 1, y: 0 }}
                      exit={{ opacity: 0, y: 8 }}
                      transition={{ duration: 0.35 }}
                    >
                      <button
                        onClick={() => setVisible(true)}
                        className="rounded-2xl px-5 py-2 bg-emerald-300 hover:bg-emerald-400 text-neutral-800"
                      >
                        Play Again
                      </button>
                    </motion.div>
                  )}
                </AnimatePresence>
              </div>
            </div>
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<MobileSlideDemo />);
    </script>
  </body>
</html>
